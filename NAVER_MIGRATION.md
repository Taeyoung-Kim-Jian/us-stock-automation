# ğŸ”„ Yahoo Finance â†’ ë„¤ì´ë²„ ê¸ˆìœµ ì „í™˜

## ğŸ“‹ ë¬¸ì œì 
Yahoo Finance API (yfinance) ì‚¬ìš© ì‹œ ì§€ì†ì ì¸ ë¬¸ì œ ë°œìƒ:
```
HTTPSConnectionPool: Max retries exceeded (429 error responses)
Failed to get ticker: Expecting value: line 1 column 1 (char 0)
```

**ì›ì¸**: GitHub Actions í™˜ê²½ì—ì„œ Yahoo Financeê°€ IP ê¸°ë°˜ìœ¼ë¡œ ìš”ì²­ì„ ì°¨ë‹¨

## ğŸ¯ ìµœì¢… ì†”ë£¨ì…˜ (v3)

### ë„¤ì´ë²„ ì°¨íŠ¸ API ì‚¬ìš©
- **NASDAQ**: `ì¢…ëª©ì½”ë“œ.O` (ì˜ˆ: AAPL.O)
- **NYSE**: `ì¢…ëª©ì½”ë“œ.N` (ì˜ˆ: JPM.N)
- **7ì¼ì¹˜ ë°ì´í„°**: í•œ ë²ˆì˜ API í˜¸ì¶œë¡œ ìµœê·¼ 7ì¼ ë°ì´í„° ìˆ˜ì§‘
- **ìë™ ê±°ë˜ì†Œ êµ¬ë¶„**: .Oì™€ .Nì„ ëª¨ë‘ ì‹œë„í•˜ì—¬ ìë™ íƒì§€

## âœ… í•´ê²° ë°©ë²•: ë„¤ì´ë²„ ê¸ˆìœµ ìŠ¤í¬ë˜í•‘

### ì™œ ë„¤ì´ë²„ ê¸ˆìœµ?
1. **í•œêµ­ ì„œë¹„ìŠ¤**: GitHub Actions IP ì°¨ë‹¨ ì—†ìŒ
2. **ì•ˆì •ì **: Rate limit ê±°ì˜ ì—†ìŒ
3. **ë¹ ë¥¸ ì†ë„**: ì‹¤í–‰ ì‹œê°„ 5-10ë¶„ (ê¸°ì¡´ 30-60ë¶„)
4. **ê°„ë‹¨í•œ êµ¬ì¡°**: BeautifulSoupìœ¼ë¡œ ì‰½ê²Œ íŒŒì‹±

### ë„¤ì´ë²„ ì°¨íŠ¸ API ì—”ë“œí¬ì¸íŠ¸
```
https://api.stock.naver.com/chart/foreign/item/AAPL.O/day?startDateTime=20250110&endDateTime=20250119
https://api.stock.naver.com/chart/foreign/item/JPM.N/day?startDateTime=20250110&endDateTime=20250119
```
- **ë¹„ê³µì‹ API** (ë„¤ì´ë²„ ê¸ˆìœµ ì°¨íŠ¸ API)
- **JSON ë°°ì—´** ì‘ë‹µìœ¼ë¡œ ì—¬ëŸ¬ ë‚ ì§œ ë°ì´í„° í•œë²ˆì— ìˆ˜ì§‘
- **ìë™ ê±°ë˜ì†Œ íƒì§€**: .O (NASDAQ), .N (NYSE) ìˆœì„œë¡œ ì‹œë„

## ğŸ”§ ì£¼ìš” ë³€ê²½ì‚¬í•­

### 1. ì˜ì¡´ì„± ë³€ê²½
**Before** (yfinance):
```
yfinance==0.2.40
pandas==2.2.0
numpy==1.26.3
```

**After** (ìµœì†Œ ì˜ì¡´ì„±):
```
requests==2.31.0
python-dotenv==1.0.0
```
- BeautifulSoupë„ ë¶ˆí•„ìš” (JSON API ì‚¬ìš©)

### 2. ë°ì´í„° ìˆ˜ì§‘ ë°©ì‹
**Before**: yfinance API í˜¸ì¶œ
```python
ticker = yf.Ticker(symbol, session=session)
hist = ticker.history(period="7d", timeout=30)
```

**After**: ë„¤ì´ë²„ ì°¨íŠ¸ API í˜¸ì¶œ (JSON ë°°ì—´ - 7ì¼ì¹˜)
```python
# NASDAQê³¼ NYSE ìë™ íƒì§€
for suffix in ['.O', '.N']:
    stock_code = f"{symbol}{suffix}"
    api_url = f"https://api.stock.naver.com/chart/foreign/item/{stock_code}/day"
    params = {"startDateTime": "20250110", "endDateTime": "20250119"}
    response = requests.get(api_url, params=params)
    data = response.json()  # ë°°ì—´ í˜•íƒœ - ì—¬ëŸ¬ ë‚ ì§œ

    # ê° ë‚ ì§œë³„ ë°ì´í„° ì²˜ë¦¬
    for item in data:
        # ëª¨ë“  ìˆ«ì í•„ë“œì—ì„œ ì‰¼í‘œ ì œê±°
        close = float(str(item.get("closePrice", "0")).replace(",", ""))
        volume = int(str(item.get("accumulatedTradingVolume", "0")).replace(",", ""))
```

### 3. ìš”ì²­ ê°„ê²©
**Before**: 2ì´ˆ + 10ê°œë§ˆë‹¤ 10ì´ˆ ëŒ€ê¸° (ë§¤ìš° ëŠë¦¼)
**After**: 0.3ì´ˆ ëŒ€ê¸° (ë¹ ë¥´ê³  ì•ˆì •ì , 7ì¼ì¹˜ í•œë²ˆì— ìˆ˜ì§‘)

## ğŸ“Š ì„±ëŠ¥ ë¹„êµ

| í•­ëª© | Yahoo Finance | ë„¤ì´ë²„ ê¸ˆìœµ (v3) |
|------|--------------|------------------|
| ì‹¤í–‰ ì‹œê°„ (500ê°œ) | 30-60ë¶„ | **3-5ë¶„** âš¡ |
| ì„±ê³µë¥  | 30-50% | **95%+** ğŸ¯ |
| Rate Limit | ì‹¬ê°í•¨ ğŸ˜¡ | **ì—†ìŒ** âœ… |
| ì•ˆì •ì„± | ë‚®ìŒ | **ë§¤ìš° ë†’ìŒ** ğŸ’ª |
| ë°ì´í„° ë²”ìœ„ | ë‹¹ì¼ë§Œ | **7ì¼ì¹˜ ìë™** ğŸ“Š |
| ê±°ë˜ì†Œ êµ¬ë¶„ | ìˆ˜ë™ | **ìë™ íƒì§€** ğŸ” |
| ê³µíœ´ì¼ ì²˜ë¦¬ | ë¶ˆê°€ | **ìë™ ì²˜ë¦¬** ğŸ‰ |

## ğŸš€ í…ŒìŠ¤íŠ¸ ë°©ë²•

### ë¡œì»¬ í…ŒìŠ¤íŠ¸
```bash
cd us_stock_automation
pip install -r requirements.txt
python scripts/update_prices.py
```

### GitHub Actions í…ŒìŠ¤íŠ¸
1. ì½”ë“œë¥¼ GitHubì— push
2. Actions íƒ­ì—ì„œ "Daily US Stock Update" ì‹¤í–‰
3. ë¡œê·¸ í™•ì¸

## ğŸ“ íŒŒì¼ ë³€ê²½ ëª©ë¡
- `scripts/update_prices.py` - ì™„ì „íˆ ì¬ì‘ì„± (ë„¤ì´ë²„ ê¸ˆìœµ ìŠ¤í¬ë˜í•‘)
- `requirements.txt` - yfinance ì œê±°, beautifulsoup4 ì¶”ê°€
- `test_yfinance.py` - ë” ì´ìƒ í•„ìš” ì—†ìŒ (ì‚­ì œ ê°€ëŠ¥)

## ğŸ¯ ê¸°ëŒ€ íš¨ê³¼
- âœ… 429 Rate Limit ì—ëŸ¬ **ì™„ì „ í•´ê²°**
- âœ… ì‹¤í–‰ ì‹œê°„ **90% ë‹¨ì¶•** (60ë¶„ â†’ 5ë¶„)
- âœ… ì„±ê³µë¥  **95% ì´ìƒ**
- âœ… **7ì¼ì¹˜ ë°ì´í„°** ìë™ ìˆ˜ì§‘ (ê³µíœ´ì¼ ëŒ€ì‘)
- âœ… **NASDAQ/NYSE ìë™ êµ¬ë¶„**
- âœ… ìœ ì§€ë³´ìˆ˜ **ê°„í¸**

## ğŸ“Œ ì£¼ìš” ê¸°ëŠ¥

### 1. ìë™ ê±°ë˜ì†Œ êµ¬ë¶„
- NASDAQ (.O)ê³¼ NYSE (.N)ë¥¼ ìë™ìœ¼ë¡œ íƒì§€
- ìˆ˜ë™ ì„¤ì • ë¶ˆí•„ìš”

### 2. 7ì¼ì¹˜ ë°ì´í„° ìˆ˜ì§‘
- í•œ ë²ˆì˜ API í˜¸ì¶œë¡œ ìµœê·¼ 7ì¼ ë°ì´í„° ìˆ˜ì§‘
- ê³µíœ´ì¼/ì£¼ë§ ìë™ ì²˜ë¦¬
- ë°ì´í„° ëˆ„ë½ ë°©ì§€

### 3. ëª¨ë“  ìˆ«ì í•„ë“œ ì‰¼í‘œ ì œê±°
- ê³ ê°€ ì£¼ì‹ (BLK $1,161, AZO $4,030) ì •ìƒ ì²˜ë¦¬
- ê±°ë˜ëŸ‰ íŒŒì‹± ì—ëŸ¬ ì™„ì „ í•´ê²°

## ğŸ“Œ ì°¸ê³ ì‚¬í•­
- ë„¤ì´ë²„ ê¸ˆìœµì€ ë¯¸êµ­ ì£¼ì‹ ì‹¤ì‹œê°„ ì‹œì„¸ ì œê³µ
- í•œêµ­ ì‹œê°„ ê¸°ì¤€ìœ¼ë¡œ ë°ì´í„° ì—…ë°ì´íŠ¸
- ì£¼ë§/ê³µíœ´ì¼ì€ ìë™ìœ¼ë¡œ ìµœê·¼ ê±°ë˜ì¼ ë°ì´í„° ì œê³µ
- ìƒì¥íì§€ ì¢…ëª©ì€ ë°ì´í„° ì—†ìŒ (ì •ìƒ)
